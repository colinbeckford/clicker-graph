<html>
<center>
  <head>
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous">
    </script>
     <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="clicker.js"> </script>
    <h1> jb2 </h1>
    <br>
    <br>
    <button id="signin-button" onclick="handleSignInClick()">Sign in to Google</button>
    <br>
    <br>
  </head>
  <body>
    <text> Input Judge Name </text>
    <br>
    <br>
    <!-- put your name here -->
    <input id="judge-name"> </input>
    <br>
    <br>
    <text> Input Youtube Link </text>
    <br>
    <br>
    <!-- yt link goes here -->
    <input id="yt-link"> </input>
    <br>
    <br>
    <!-- submit link button to initialize iframe (below) with youtube video -->
    <button id="submit" onclick="saveData()"> Submit </button>
    <br>
    <br>
    <!-- text that gets updated with clicks -->
    <h1 id="click-display"> +0 -0 </h1>
    <br>
    <br>
    <div id="chart"> </div>
    <script type="text/javascript">
    function getLinks() {
      var params = {
        spreadsheetId: '1KrN4qEuSED2x3R_Y4dOSXoHYix6ccP3SBlMMsDxgLO0',
        range: "Sheet1!B1:B500",
        valueRenderOption: 'FORMATTED_VALUE',
        dateTimeRenderOption: 'FORMATTED_STRING',
      };
      var links = gapi.client.sheets.spreadsheets.values.get(params);
      links.then(function(response) {
        for (var i=0;i<response.result.values.length;i++)
        {
          if (response.result.values[i] == yt_link)
          {
              getOtherScores(i);
          }
        }
      }, function(reason) {
        console.error('error: ' + reason.result.error.message);
      });
    }

    function getOtherScores(index)
    {
      var params = {
        spreadsheetId: '1KrN4qEuSED2x3R_Y4dOSXoHYix6ccP3SBlMMsDxgLO0',
        range: "Sheet1!A" + (index+1) + ":FZ" + (index+1),
        valueRenderOption: 'FORMATTED_VALUE',
        dateTimeRenderOption: 'FORMATTED_STRING',
      };
      var otherScores = gapi.client.sheets.spreadsheets.values.get(params);
      otherScores.then(function(response) {
        otherJudge = response.result.values[0];
        for (var i=2;i<response.result.values.length;i++)
        {
          var data = response.result.values[i].split(',');
          otherGraph.push(data);
        }
        console.log(otherGraph);
      }, function(reason) {
        console.error('error: ' + reason.result.error.message);
      });
    }

    function filterList(list)
    {
      for (var i=0;i<list.length;i++)
      {
        if (list[i] == "Break")
        {
          for (var j=0;j<i;j++)
          {
            var data = list[j].split(',');
            if (data[0] == "")
            {
              break;
            }
            else
            {
            data[0] = parseInt(data[0]);
            data[1] = parseInt(data[1]);
            graph2.push(data);
            }
          }
          break;
        }
      }
    }

    function makeApiCall(list) {
         var params = {
           spreadsheetId:'1KrN4qEuSED2x3R_Y4dOSXoHYix6ccP3SBlMMsDxgLO0',
           range: 'Sheet1!A1:FZ250',
           valueInputOption: 'RAW',
           insertDataOption: 'OVERWRITE',
         };
         var valueRangeBody = {
               "range": 'Sheet1!A1:FZ250',
          "majorDimension": 'ROWS',
          "values": [list]
         };
         var request = gapi.client.sheets.spreadsheets.values.append(params, valueRangeBody);
         request.then(function(response) {
           //showChart();
           getLinks();
         }, function(reason) {
           console.error('error: ' + reason.result.error.message);
         });
       }

    function initClient() {
    var API_KEY = "AIzaSyBL78U6X04LeYMJ2h-35dPoPnXduUx_opo";
    var CLIENT_ID = "174011806378-ruu4bj26124mrbejev4btf1v4v8kslrb.apps.googleusercontent.com";
    var SCOPE = 'https://www.googleapis.com/auth/spreadsheets';

    gapi.client.init({
      'apiKey': API_KEY,
      'clientId': CLIENT_ID,
      'scope': SCOPE,
      'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
    }).then(function() {
      gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
      updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
    });
    }

    function handleClientLoad() {
    gapi.load('client:auth2', initClient);
    }

    function updateSignInStatus(isSignedIn) {
    if (isSignedIn) {
      alert("You are signed in.");
    }
    }
    function handleSignInClick(event) {
    gapi.auth2.getAuthInstance().signIn();
    }
    function handleSignOutClick(event) {
    gapi.auth2.getAuthInstance().signOut();
    }
    </script>

    <script async defer src="https://apis.google.com/js/api.js"
onload="this.onload=function(){};handleClientLoad()"
onreadystatechange="if (this.readyState === "complete") this.onload()">
</script>
  </body>
</center>

</html>
