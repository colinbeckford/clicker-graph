<html>
<center>
  <head>
    <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

    <script src="clicker.js"> </script>
    <script src="https://www.gstatic.com/charts/loader.js"> </script>
    <h1> jb2 </h1>
    <br>
    <br>
    <button id="signin-button" onclick="handleSignInClick()">Sign in to Google</button>
    <br>
    <br>
  </head>
  <body>
    <text> Input Judge Name </text>
    <br>
    <br>
    <!-- put your name here -->
    <input id="judge-name"> </input>
    <br>
    <br>
    <text> Input Youtube Link </text>
    <br>
    <br>
    <!-- yt link goes here -->
    <input id="yt-link"> </input>
    <br>
    <br>
    <!-- submit link button to initialize iframe (below) with youtube video -->
    <button id="submit" onclick="saveData()"> Submit </button>
    <br>
    <br>
    <!-- text that gets updated with clicks -->
    <h1 id="click-display"> +0 -0 </h1>
    <br>
    <br>
    <div id="chart"> </div>
    <script type="text/javascript">
    function getLinks() {
      var params = {
        spreadsheetId: '1KrN4qEuSED2x3R_Y4dOSXoHYix6ccP3SBlMMsDxgLO0',
        range: "Sheet1!B1:DZ250",
        valueRenderOption: 'FORMATTED_VALUE',
        dateTimeRenderOption: 'FORMATTED_STRING',
      };
      var request = gapi.client.sheets.spreadsheets.values.get(params);
      request.then(function(response) {
        for (var i=0;i<response.result.values[0].length;i++)
        {
          if (response.result.values[1][i] == yt_link)
          {
            for (var j=2;j<response.result.values.length;j++)
            {
              otherGraphs.push(response.result.values[j][i]);
            }
            otherGraphs.push("Break");
          }
        }
        filterList(otherGraphs);
      }, function(reason) {
        console.error('error: ' + reason.result.error.message);
      });
    }

    function filterList(list)
    {
      for (var i=0;i<list.length;i++)
      {
        console.log("In filter list loop");
        if (list[i] == "Break")
        {
          console.log("Hitting break point");
          for (var j=0;j<i;j++)
          {
            var data = list[j].split(',');
            console.log(data);
            graph2.push(data);
          }
        }
      }
      console.log(graph2);
      makeApiCall(judgeEntry);
    }

    function makeApiCall(list) {
         var params = {
           spreadsheetId:'1KrN4qEuSED2x3R_Y4dOSXoHYix6ccP3SBlMMsDxgLO0',
           range: 'Sheet1!B1:Z250',
           valueInputOption: 'RAW',
           insertDataOption: 'OVERWRITE',
         };
         var valueRangeBody = {
               "range": 'Sheet1!B1:Z250',
          "majorDimension": 'COLUMNS',
          "values": [
            list
          ]
         };
         var request = gapi.client.sheets.spreadsheets.values.append(params, valueRangeBody);
         request.then(function(response) {
           console.log("Scores appended");
         }, function(reason) {
           console.error('error: ' + reason.result.error.message);
         });
         drawBasic();
       }

    function initClient() {
    var API_KEY = "AIzaSyBL78U6X04LeYMJ2h-35dPoPnXduUx_opo";
    var CLIENT_ID = "174011806378-ruu4bj26124mrbejev4btf1v4v8kslrb.apps.googleusercontent.com";
    var SCOPE = 'https://www.googleapis.com/auth/spreadsheets';

    gapi.client.init({
      'apiKey': API_KEY,
      'clientId': CLIENT_ID,
      'scope': SCOPE,
      'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
    }).then(function() {
      gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
      updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
    });
    }

    function handleClientLoad() {
    gapi.load('client:auth2', initClient);
    }

    function updateSignInStatus(isSignedIn) {
    if (isSignedIn) {
      alert("You are signed in.");
    }
    }
    function handleSignInClick(event) {
    gapi.auth2.getAuthInstance().signIn();
    }
    function handleSignOutClick(event) {
    gapi.auth2.getAuthInstance().signOut();
    }
    </script>

    <script async defer src="https://apis.google.com/js/api.js"
onload="this.onload=function(){};handleClientLoad()"
onreadystatechange="if (this.readyState === "complete") this.onload()">
</script>
  </body>
</center>

</html>
